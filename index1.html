<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BUY-LIST</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f4f4f4; }
        .completed { background-color: #d4edda; }
        .info-box {
        background-color: #e5e5e5; /* –°–µ—Ä—ã–π —Ñ–æ–Ω */
        padding: 10px;
        border-radius: 5px;
        font-family: Arial, sans-serif;
        font-size: 14px;
        color: #1f3b63; /* –¢–µ–º–Ω–æ-—Å–∏–Ω–∏–π —Ç–µ–∫—Å—Ç */
    }

    .info-box p {
        margin: 5px 0;
    }

    .info-box strong {
        font-size: 14px; /* –†–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ */
    }
    .save-button {
            padding: 8px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-left: 10px;}
    body {
      padding-bottom: 100px; /* –∏–ª–∏ –±–æ–ª—å—à–µ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
    }

    </style>
</head>
<body>
    <div class="info-box">
        <p><strong>CLIENT:</strong><br>CARBON GAMING LLC</p>
        <p><strong>PROJECT LOCATION:</strong><br>Dubai, Meydan One, Aziz Riviera 23</p>
    </div>


    <table border="1">
    <tr>
        <th>‚Ññ</th>
        <th>DESCRIPTION OF WORKS</th>
        <th>QTY</th>
        <th>UNIT</th>
        <th>Notes</th>
    </tr>
        <tr>
            <th><strong>1</strong></th>
            <th>PRELIMINARY WORKS</th> 
            <th>144</th>
            <th>SQM/Floor</th>
            <th></th>
        </tr>
        <tr>
            <th>1.1</th>
            <th>Mobilization / demobilization, transportation for the personnel, materials and equipment</th>
            <th></th>
            <th></th>
            <th><input type="text"></th>
        </tr>    
        <tr>
            <th><strong>2</strong></th>
            <th>AC WORKS</th> 
            <th></th>
            <th></th>
            <th></th>
        </tr>
        <tr>
            <th>2.1</th>
            <th>Supply & installation of chilled water FCU, 3.5Tons capacity which includes:
              <br>
              a. Installation of fan coil unit with hangers and fasteners
              <br>
              b. Power connection from the point close to the units provided by others
              <br>
              c. Supply & fixing of condensate drain connection to the nearest drain point with rubber
            </th>
            <th>3</th>
            <th>Nos.</th>
            
            <th><input type="text"></th>
        </tr>
        <tr>
            <th><strong>3</strong></th>
            <th>PLUMBING WORKS</th>
            <th></th>
            <th></th>
            <th></th>
        </tr>
        <tr>
            <th>3.1</th>
            <th>Supply and installation of a 60cm hand wash basin
</th>
            <th>3</th>
            <th>PCS</th>
            <th><input type="text"></th>
        </tr>
        <tr>
            <th>3.2</th>
            <th>Supply and installation of a hand wash mixer</th>
            <th>3</th>
            <th>PCS</th>
            <th><input type="text"></th>
        </tr> 
                <tr>
            <th>3.3</th>
            <th>Supply and installation of toilet</th>
            <th>2</th>
            <th>PCS</th>
            <th><input type="text"></th>
        </tr> 
                <tr>
            <th>3.4</th>
            <th>Supply and installation of taps for cold water supply</th>
            <th>7</th>
            <th>points</th>
            <th><input type="text"></th>
        </tr> 
                <tr>
            <th>3.5</th>
            <th>Supply and installation of hygienic showers</th>
            <th>2</th>
            <th>points</th>
            <th><input type="text"></th>
        </tr> 
        <tr>
            <th>3.6</th>
            <th>Supply of accessories toilet paper holders, cleaning brush, trash can</th>
            <th>2</th>
            <th>set</th>
            <th><input type="text"></th>
        </tr> 
                <tr>
            <th>3.7</th>
            <th>Mirror for sink 40*50cm</th>
            <th>3</th>
            <th>PCS</th>
            <th><input type="text"></th>
        </tr> 
                <tr>
            <th>3.8</th>
            <th>Paper Towel Dispenser</th>
            <th>3</th>
            <th>PCS</th>
            <th><input type="text"></th>
        </tr> 
                <tr>
            <th>3.9</th>
            <th>Soap Dispenser</th>
            <th>3</th>
            <th>PCS</th>
            <th><input type="text"></th>
        </tr>   
        <tr>
            <th><strong>4</strong></th>
            <th>CONSTRUCTION WORK</th>
            <th></th>
            <th></th>
            <th></th>
        </tr>
        <tr>
            <th>4.1</th>
            <th>Supply and installation skirtings for new walls</th>
            <th>92</th>
            <th>R/M</th>
            <th><input type="text"></th>
        </tr>
                <tr>
            <th>4.2</th>
            <th>Supply and installation of tempered glass doors 2,30*0,80m</th>
            <th>4</th>
            <th>Set</th>
            <th><input type="text"></th>
        </tr>
                <tr>
            <th>4.3</th>
            <th>Supply and installation of MDF doors 2,30*0,80m</th>
            <th>3</th>
            <th>Set</th>
            <th><input type="text"></th>
        </tr>
                <tr>
            <th>4.1</th>
            <th>Supply and installation of MDF doors 2,30*0,90m</th>
            <th>2</th>
            <th>Set</th>
            <th><input type="text"></th>
        </tr>
        <tr>
            <th><strong>5</strong></th>
            <th>FLOORING WORK</th>
            <th></th>
            <th></th>
            <th></th>
        </tr> 
        <tr>
            <th>5.1</th>
            <th>Application and finishing of up to 100mm thick rapid screed Material should be provided at the point of application.
              <br>
                -Fixing of Construction joint/profile by M.C
                <br>
                -Cleaning, Shutting, preparing the surface by M.C.</th>
            <th>144</th>
            <th>SQM</th>
            
            <th><input type="text"></th>
        </tr> 
         <tr>
            <th>5.2</th>
            <th>Supply and installation of tiles with grouting. Kerakoll Italy MOS. Floor only </th>
            <th>144</th>
            <th>SQM</th>
            <th><input type="text"></th>  
          </tr> 
    </td>
        <tr>
            <th><strong>6</strong></th>
            <th>ELECTRICAL POWER WORKS</th>
            <th>1</th>
            <th>unit</th>
            <th></th>
        </tr>
        <tr>
            <th>6.8</th>
            <th>Supply and installation of 13A Twin socket</th>
            <th>22</th>
            <th>pcs</th>
            <th><input type="text"></th>
        </tr>
        <tr>
            <th>6.9</th>
            <th>Supply and installation of Floor box 13A Twin sockets & DATA point</th>
            <th>25</th>
            <th>pcs</th>
            <th><input type="text"></th>
        </tr>
        <tr>
            <th>6.10</th>
            <th>Supply and installation of data points for wall sockets</th>
            <th>3</th>
            <th>pcs</th>
            <th><input type="text"></th>
        </tr>
        <tr>
            <th><strong>7</strong></th>
            <th>ELECTRICAL FURNITURE/WALL LIGHTING LIGHTING WORKS</th>    
            <th></th>
            <th></th>
            <th></th>
        </tr>
        <tr>
            <th>7.1</th>
            <th>Supply and installation of switches for lighting</th>
            <th>3</th>
            <th>points</th>
            
            <th><input type="text"></th>
        </tr>
    </td>
    </td>
    </table>
        
    <p>
    <strong>Number of works:</strong> <span id="total-jobs">0</span>
    </p>

    <p><button class="save-button no-pdf" onclick="saveData()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button></p>
    

    <script>
   function calculateTotal() {
      let inputs = document.querySelectorAll('.percent-input');
      let total = 0;
      let count = 0;
      let jobCount = 0;
      inputs.forEach(input => {
        let value = parseFloat(input.value);
        if (!isNaN(value)) {
          total += value;
          count++;
          jobCount++;
        }
      });
      let average = count > 0 ? (total / count).toFixed(2) : 0;
      document.getElementById('total-percent').innerText = average;
      document.getElementById('total-jobs').textContent = jobCount;
      localStorage.setItem('totalJobs', jobCount);
    }

    function saveData() {
      let inputs = document.querySelectorAll('.percent-input');
      let values = [];
      inputs.forEach(input => {
        values.push(input.value);
      });
      localStorage.setItem('percentValues', JSON.stringify(values));
      localStorage.setItem('totalPercent', document.getElementById('total-percent').textContent);
      alert("–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!");
    }

    function loadData() {
      let savedValues = JSON.parse(localStorage.getItem('percentValues'));
      let savedTotal = localStorage.getItem('totalPercent');
      let savedJobs = localStorage.getItem('totalJobs');
      if (savedValues) {
        let inputs = document.querySelectorAll('.percent-input');
        inputs.forEach((input, index) => {
          input.value = savedValues[index] || 0;
        });
      }
      if (savedTotal) {
        document.getElementById('total-percent').textContent = savedTotal;
      }
      if (savedJobs) {
        document.getElementById('total-jobs').textContent = savedJobs;
      }
    }

    window.onload = loadData;
  </script>

  <script>
    emailjs.init("VB4XxK6jjsQUENSOA"); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º EmailJS

    function sendEmail() {
      let rows = document.querySelectorAll("table tr");
      let tableText = "";
      rows.forEach((row, rowIndex) => {
        let cols = row.querySelectorAll("td, th");
        let rowData = [];
        if (rowIndex === 0) return;
        cols.forEach((col, index) => {
          if (index === 0) {
            rowData.push(col.innerText);
          } else if (index === 1) {
            rowData.push(col.innerText);
          } else {
            let input = col.querySelector("input.percent-input");
            if (input) {
              rowData.push(input.value + "%");
            } else {
              rowData.push("");
            }
          }
        });
        if (rowData.length > 0) {
          tableText += rowData.join(" | ") + "\n";
        }
      });
      let totalPercent = document.getElementById('total-percent') ? document.getElementById('total-percent').textContent : '0';
      let totalJobs = document.getElementById('total-jobs') ? document.getElementById('total-jobs').textContent : '0';
      tableText += `\n–ò—Ç–æ–≥–æ: ${totalPercent}%\n`;
      tableText += `–í—Å–µ–≥–æ —Ä–∞–±–æ—Ç: ${totalJobs}\n`;
      // –ï—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è, —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É —á–µ—Ä–µ–∑ EmailJS
      // emailjs.send("service_m417yhp", "template_muub3fw", {
      //   to_email: "razakovshoh7@gmail.com",
      //   message_html: tableText
      // }).then(function(response) {
      //   alert("–¢–∞–±–ª–∏—Ü–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!");
      // }, function(error) {
      //   alert("–û—à–∏–±–∫–∞: " + JSON.stringify(error));
      // });
    }
  </script>

  <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è PDF (—Å–∫—Ä—ã–≤–∞–µ–º –≤ PDF) -->
  <button class="save-button no-pdf" id="downloadPDF">üì• –°–∫–∞—á–∞—Ç—å —Å–∞–π—Ç –≤ PDF</button>

  <script>
    document.getElementById("downloadPDF").addEventListener("click", function () {
      // –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∫–ª–∞—Å—Å–æ–º no-pdf (—Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∏)
      var elementsToHide = document.querySelectorAll('.no-pdf');
      elementsToHide.forEach(function (el) {
        el.style.display = "none";
      });
      // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
      var downloadButton = this;
      downloadButton.style.display = "none";

      // –ñ–¥—ë–º, —á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä –æ–±–Ω–æ–≤–∏–ª –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
      setTimeout(() => {
        html2canvas(document.body, { scale: 2 }).then(function (canvas) {
          const { jsPDF } = window.jspdf;
          const pdf = new jsPDF('p', 'mm', 'a4');
          const pageWidth = pdf.internal.pageSize.getWidth();
          const pageHeight = pdf.internal.pageSize.getHeight();

          // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—ã—Å–æ—Ç—É –æ–¥–Ω–æ–≥–æ PDF-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –ø–∏–∫—Å–µ–ª—è—Ö –∏—Å—Ö–æ–¥–Ω–æ–≥–æ canvas
          const canvasPageHeight = (canvas.width * pageHeight) / pageWidth;
          const totalPages = Math.ceil(canvas.height / canvasPageHeight);

          for (let i = 0; i < totalPages; i++) {
            // –°–æ–∑–¥–∞—ë–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π canvas –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const canvasPage = document.createElement("canvas");
            canvasPage.width = canvas.width;
            canvasPage.height = canvasPageHeight;
            const ctx = canvasPage.getContext("2d");

            // –†–∏—Å—É–µ–º —á–∞—Å—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ canvas, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            ctx.drawImage(
              canvas,
              0,
              i * canvasPageHeight,
              canvas.width,
              canvasPageHeight,
              0,
              0,
              canvas.width,
              canvasPageHeight
            );

            const imgData = canvasPage.toDataURL("image/png");
            if (i > 0) {
              pdf.addPage();
            }
            // –í—ã—á–∏—Å–ª—è–µ–º –≤—ã—Å–æ—Ç—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ PDF
            const pdfImgHeight = (canvasPageHeight * pageWidth) / canvas.width;
            pdf.addImage(imgData, 'PNG', 0, 0, pageWidth, pdfImgHeight);
          }

          pdf.save('site.pdf');

          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–Ω–µ–µ —Å–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
          elementsToHide.forEach(function (el) {
            el.style.display = "";
          });
          downloadButton.style.display = "block";
        });
      }, 100);
    });
  </script>
</body>
</html>
